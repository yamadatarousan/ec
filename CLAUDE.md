# ECサイト開発プロジェクト - AIエージェント行動規則

## プロジェクト概要
- **プロジェクト名**: ECサイトWebアプリケーション
- **参考サイト**: Amazon
- **開発環境**: ローカル環境（Mac）
- **目的**: 学習・実験用（決済処理は含まない）

## 技術スタック

### 必須技術スタック
- **フロントエンド**: Next.js 15.3.3（2024年12月最新安定版）
- **言語**: TypeScript 5.8.3（2024年最新安定版）
- **スタイリング**: TailwindCSS 4.1.10（2024年11月v4.0リリース）
- **ORM**: Prisma 6.10.0（2024年11月v6.0リリース）
- **データベース**: PostgreSQL 17.5（2024年9月v17リリース）
- **テストツール**: Jest + Testing Library（最新安定版）
- **デプロイ**: Vercel（予定）
- **CI/CD**: GitHub Actions

### 追加技術スタック
- **認証**: NextAuth.js（最新安定版）
- **状態管理**: Zustand or React Context（プロジェクト規模に応じて）
- **バリデーション**: Zod（最新安定版）
- **画像最適化**: Next.js Image component + Cloudinary（予定）
- **コード品質**: ESLint + Prettier
- **コミットルール**: Conventional Commits

### バージョン例外・注意事項
- **TailwindCSS v4.0**: 2024年11月にリリース。Safari 16.4+、Chrome 111+、Firefox 128+が必要。古いブラウザサポートが必要な場合はv3.4を使用
- **Prisma v6.0**: 2024年11月にリリース。破壊的変更あり、アップグレードガイド要確認  
- **PostgreSQL 17**: 2024年9月にリリース。メモリ管理とパフォーマンスが大幅改善
- **Next.js 15**: React 19サポート、Turbopack安定版、非同期Request API

## 開発規則

### コード品質
1. **Docコメント必須**: 全ての関数、コンポーネント、カスタムフック、型定義にJSDocコメントを記述
2. **TypeScript厳格モード**: strict: trueで開発
3. **コンポーネント設計**: 単一責任の原則に従い、再利用可能なコンポーネントを作成
4. **ディレクトリ構造**: 機能ベース + レイヤー構造のハイブリッド

### ディレクトリ構造
```
/src
  /app (App Router)
    /api
    /(routes)
  /components
    /ui (再利用可能なUIコンポーネント)
    /features (機能固有のコンポーネント)
  /lib (ユーティリティ、設定)
  /hooks (カスタムフック)
  /types (型定義)
  /utils (ヘルパー関数)
  /data (モックデータ、定数)
/prisma
  /schema.prisma
  /migrations
/public
/tests
/__tests__ or /src/__tests__
```

### 命名規則
- **コンポーネント**: PascalCase (`ProductCard.tsx`)
- **ファイル**: kebab-case (`user-profile.tsx`)
- **関数・変数**: camelCase (`getUserData`)
- **定数**: UPPER_SNAKE_CASE (`API_BASE_URL`)
- **型・インターフェース**: PascalCase (`UserProfile`, `ProductData`)

### コミット規則
- Conventional Commitsに従う
- `feat:`, `fix:`, `docs:`, `style:`, `refactor:`, `test:`, `chore:`
- 日本語コミットメッセージ可

## 機能要件

### 主要機能
1. **商品管理**
   - 商品一覧表示
   - 商品詳細表示
   - カテゴリ別表示
   - 検索機能

2. **ユーザー機能**
   - ユーザー登録・ログイン
   - プロフィール管理
   - 注文履歴

3. **ショッピング機能**
   - カート機能
   - お気に入り機能
   - 注文機能（決済処理除く）

4. **管理機能**
   - 商品管理
   - ユーザー管理
   - 注文管理

### 除外機能
- 決済処理（Stripe等との連携）
- 実際の配送処理
- 外部API連携（必要最小限のみ）

## 開発フロー

### 開発手順
1. 機能設計・DB設計
2. Prismaスキーマ作成
3. API Route作成
4. コンポーネント作成
5. テスト作成
6. 動作確認

### テスト方針
- **単体テスト**: 全てのユーティリティ関数、カスタムフック
- **コンポーネントテスト**: 主要なコンポーネント
- **統合テスト**: API Routes
- **E2Eテスト**: 主要なユーザーフロー（必要に応じて）

### コード品質チェック
- ESLint + Prettier実行
- TypeScriptコンパイルエラーなし
- テスト通過
- ビルドエラーなし

## AIエージェント行動規則

### 基本方針
1. **日本語応答**: 全ての応答は日本語で行う
2. **段階的開発**: 小さな機能単位で開発・テスト
3. **品質重視**: 動作するコードより保守性の高いコードを優先
4. **説明責任**: 技術選択の理由を明確にする

### 作業フロー
1. 要件確認・詳細化
2. 設計・技術選択
3. 実装
4. テスト
5. ドキュメント更新

### 禁止事項
- Docker使用禁止
- 決済機能実装禁止
- セキュリティを軽視した実装禁止
- テストを省略した実装禁止

### 推奨事項
- 段階的な機能追加
- コード品質の維持
- 適切なエラーハンドリング
- アクセシビリティの考慮

## 更新履歴
- 2025-06-18: 初版作成